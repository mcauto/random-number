<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div class="section">
      <div class="wrapper-div">
        <span id="result">&nbsp;</span>
        <div>
          <button id="randomButton" type="button" class="button">
            PUSH ME!
          </button>
        </div>
      </div>
    </div>

    <script type="module">
      'use strict'
      const MAX_COUNT = 5
      const END_MESSAGE = 'ë—'
      const DEBOUNCING_INTERVAL = 200

      function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1))
          ;[arr[i], arr[j]] = [arr[j], arr[i]]
        }
        return arr
      }
      var stack = [...Array(MAX_COUNT).keys()]

      window.onload = function() {
        let randomButton = document.getElementById('randomButton')
        var timer
        randomButton.addEventListener('click', function() {
          if (timer) {
            clearTimeout(timer)
          }
          timer = setTimeout(function() {
            shuffle(stack)
            let num = stack.pop()
            document.getElementById('result').innerText = num + 1
            if (stack.length === 0 && num === undefined) {
              randomButton.remove()
              document.getElementById('result').innerText = END_MESSAGE
            }
          }, DEBOUNCING_INTERVAL)
        })
      }
    </script>
  </body>
</html>
